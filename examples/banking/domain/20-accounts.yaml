# Soni Banking Assistant - Account Flows
# Balance and transaction flows

flows:
  check_balance:
    description: "Check the balance of a bank account"
    trigger:
      intents:
        - "What is my balance?"
        - "How much money do I have?"
        - "Check my balance"
        - "Balance please"
        - "What's in my account?"
        - "Show me my balance"
        - "How much is in my {account_type}?"
        - "What about my {account_type}?"
        - "And my {account_type}?"
    steps:
      - step: collect_account
        type: collect
        slot: account_type
        message: "Which account would you like to check? I can show you your checking, savings, or investment account."

      - step: fetch_balance
        type: action
        call: get_balance
        map_outputs:
          balance: balance
          currency: currency

      - step: format_response
        type: action
        call: format_balance_message
        map_outputs:
          message: message

      - step: say_balance
        type: say
        message: "{message}"

  check_transactions:
    description: "View recent account transactions and movements"
    trigger:
      intents:
        - "Show me my transactions"
        - "Recent movements"
        - "What have I spent?"
        - "Show my last transactions"
        - "Transaction history"
        - "What charges do I have?"
        - "Show me my spending"
    steps:
      - step: collect_account
        type: collect
        slot: account_type
        message: "Which account would you like to see transactions for?"

      - step: collect_period
        type: collect
        slot: transaction_period
        message: "For what time period? I can show you the last week, last month, or last 3 months."

      - step: fetch_transactions
        type: action
        call: get_transactions
        map_outputs:
          transactions_summary: transactions_summary
          total_income: total_income
          total_expenses: total_expenses

      - step: say_transactions
        type: say
        message: |
          Here are your recent transactions from your {account_type} account ({transaction_period}):

          {transactions_summary}

          Summary:
          - Total income: +{total_income} EUR
          - Total expenses: {total_expenses} EUR
