{
  "extractor.predict": {
    "traces": [],
    "train": [],
    "demos": [
      {
        "user_message": "laptop",
        "history": [
          {
            "user_message": "I want to search_product"
          }
        ],
        "context": {
          "available_flows": [
            {
              "name": "search_product",
              "description": "Search for products by name or category",
              "trigger_intents": [
                "I'm looking for a",
                "Show me",
                "I want to buy a",
                "Can you help me find a"
              ]
            },
            {
              "name": "add_to_cart",
              "description": "Add products to your shopping cart",
              "trigger_intents": []
            },
            {
              "name": "checkout",
              "description": "Complete purchase and payment",
              "trigger_intents": []
            },
            {
              "name": "track_order",
              "description": "Track the status of an order shipment",
              "trigger_intents": []
            },
            {
              "name": "return_product",
              "description": "Return a product and get a refund",
              "trigger_intents": []
            }
          ],
          "available_commands": [
            {
              "command_type": "start_flow",
              "description": "Start a new flow",
              "required_fields": [
                "flow_name"
              ],
              "example": ""
            },
            {
              "command_type": "set_slot",
              "description": "Set a slot value",
              "required_fields": [
                "slot",
                "value"
              ],
              "example": ""
            },
            {
              "command_type": "cancel_flow",
              "description": "Cancel the current flow",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "affirm",
              "description": "Confirm a pending action (user says yes)",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "deny",
              "description": "Deny a pending action (user says no)",
              "required_fields": [
                "slot_to_change"
              ],
              "example": ""
            },
            {
              "command_type": "correct_slot",
              "description": "Correct a previously set slot value",
              "required_fields": [
                "slot",
                "new_value"
              ],
              "example": ""
            },
            {
              "command_type": "clarify",
              "description": "User requests clarification about something",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "chitchat",
              "description": "Off-topic conversation or small talk",
              "required_fields": [],
              "example": ""
            }
          ],
          "active_flow": "search_product",
          "flow_slots": [
            {
              "name": "product",
              "slot_type": "string",
              "description": "What product are you looking for?",
              "required": true,
              "examples": [
                "laptop",
                "phone",
                "headphones"
              ]
            },
            {
              "name": "quantity",
              "slot_type": "number",
              "description": "How many would you like to order?",
              "required": true,
              "examples": [
                "1",
                "2",
                "3"
              ]
            },
            {
              "name": "color",
              "slot_type": "string",
              "description": "What color would you prefer?",
              "required": true,
              "examples": [
                "black",
                "white",
                "silver"
              ]
            },
            {
              "name": "size",
              "slot_type": "string",
              "description": "What size do you need?",
              "required": true,
              "examples": [
                "small",
                "medium",
                "large"
              ]
            },
            {
              "name": "shipping_address",
              "slot_type": "address",
              "description": "What's the shipping address?",
              "required": true,
              "examples": [
                "123 Main St",
                "456 Oak Ave",
                "789 Pine Rd"
              ]
            }
          ],
          "current_slots": [],
          "expected_slot": "product",
          "conversation_state": "collecting"
        },
        "result": {
          "commands": [
            {
              "type": "set_slot",
              "slot": "product",
              "value": "laptop",
              "confidence": 1.0
            }
          ],
          "confidence": 0.95
        }
      },
      {
        "user_message": "I want to transfer_funds with recipient mom and account_type checking",
        "history": [],
        "context": {
          "available_flows": [
            {
              "name": "transfer_funds",
              "description": "Transfer money between accounts or to other people",
              "trigger_intents": [
                "I want to transfer money",
                "Send funds",
                "Make a payment",
                "Transfer to"
              ]
            },
            {
              "name": "check_balance",
              "description": "Check your account balance or how much money you have",
              "trigger_intents": [
                "What is my balance?",
                "Check my account",
                "How much money do I have",
                "How much do I have?",
                "What's my balance?",
                "Show me my funds",
                "How much is in my account?",
                "What's in my account?"
              ]
            },
            {
              "name": "activate_card",
              "description": "Activate a new debit or credit card",
              "trigger_intents": []
            },
            {
              "name": "block_card",
              "description": "Block a lost or stolen card",
              "trigger_intents": []
            },
            {
              "name": "transaction_history",
              "description": "View recent transactions and account activity",
              "trigger_intents": []
            }
          ],
          "available_commands": [
            {
              "command_type": "start_flow",
              "description": "Start a new flow",
              "required_fields": [
                "flow_name"
              ],
              "example": ""
            },
            {
              "command_type": "set_slot",
              "description": "Set a slot value",
              "required_fields": [
                "slot",
                "value"
              ],
              "example": ""
            },
            {
              "command_type": "cancel_flow",
              "description": "Cancel the current flow",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "affirm",
              "description": "Confirm a pending action (user says yes)",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "deny",
              "description": "Deny a pending action (user says no)",
              "required_fields": [
                "slot_to_change"
              ],
              "example": ""
            },
            {
              "command_type": "correct_slot",
              "description": "Correct a previously set slot value",
              "required_fields": [
                "slot",
                "new_value"
              ],
              "example": ""
            },
            {
              "command_type": "clarify",
              "description": "User requests clarification about something",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "chitchat",
              "description": "Off-topic conversation or small talk",
              "required_fields": [],
              "example": ""
            }
          ],
          "active_flow": null,
          "flow_slots": [
            {
              "name": "amount",
              "slot_type": "number",
              "description": "How much would you like to transfer?",
              "required": true,
              "examples": [
                "10",
                "50",
                "100"
              ]
            },
            {
              "name": "currency",
              "slot_type": "string",
              "description": "In which currency?",
              "required": true,
              "examples": [
                "USD",
                "EUR",
                "GBP"
              ]
            },
            {
              "name": "recipient",
              "slot_type": "string",
              "description": "Who would you like to send money to?",
              "required": true,
              "examples": [
                "mom",
                "dad",
                "landlord"
              ]
            },
            {
              "name": "account_type",
              "slot_type": "string",
              "description": "Which account (checking or savings)?",
              "required": true,
              "examples": [
                "checking",
                "savings",
                "current"
              ]
            },
            {
              "name": "card_last_4",
              "slot_type": "number",
              "description": "What are the last 4 digits of the card?",
              "required": true,
              "examples": [
                "1234",
                "5678",
                "9012"
              ]
            }
          ],
          "current_slots": [],
          "expected_slot": "amount",
          "conversation_state": "idle"
        },
        "result": {
          "commands": [
            {
              "type": "start_flow",
              "flow_name": "transfer_funds",
              "slots": {}
            },
            {
              "type": "set_slot",
              "slot": "recipient",
              "value": "mom",
              "confidence": 1.0
            },
            {
              "type": "set_slot",
              "slot": "account_type",
              "value": "checking",
              "confidence": 1.0
            }
          ],
          "confidence": 0.9
        }
      },
      {
        "user_message": "I want to search_product with quantity 1 and color black",
        "history": [],
        "context": {
          "available_flows": [
            {
              "name": "search_product",
              "description": "Search for products by name or category",
              "trigger_intents": [
                "I'm looking for a",
                "Show me",
                "I want to buy a",
                "Can you help me find a"
              ]
            },
            {
              "name": "add_to_cart",
              "description": "Add products to your shopping cart",
              "trigger_intents": []
            },
            {
              "name": "checkout",
              "description": "Complete purchase and payment",
              "trigger_intents": []
            },
            {
              "name": "track_order",
              "description": "Track the status of an order shipment",
              "trigger_intents": []
            },
            {
              "name": "return_product",
              "description": "Return a product and get a refund",
              "trigger_intents": []
            }
          ],
          "available_commands": [
            {
              "command_type": "start_flow",
              "description": "Start a new flow",
              "required_fields": [
                "flow_name"
              ],
              "example": ""
            },
            {
              "command_type": "set_slot",
              "description": "Set a slot value",
              "required_fields": [
                "slot",
                "value"
              ],
              "example": ""
            },
            {
              "command_type": "cancel_flow",
              "description": "Cancel the current flow",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "affirm",
              "description": "Confirm a pending action (user says yes)",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "deny",
              "description": "Deny a pending action (user says no)",
              "required_fields": [
                "slot_to_change"
              ],
              "example": ""
            },
            {
              "command_type": "correct_slot",
              "description": "Correct a previously set slot value",
              "required_fields": [
                "slot",
                "new_value"
              ],
              "example": ""
            },
            {
              "command_type": "clarify",
              "description": "User requests clarification about something",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "chitchat",
              "description": "Off-topic conversation or small talk",
              "required_fields": [],
              "example": ""
            }
          ],
          "active_flow": null,
          "flow_slots": [
            {
              "name": "product",
              "slot_type": "string",
              "description": "What product are you looking for?",
              "required": true,
              "examples": [
                "laptop",
                "phone",
                "headphones"
              ]
            },
            {
              "name": "quantity",
              "slot_type": "number",
              "description": "How many would you like to order?",
              "required": true,
              "examples": [
                "1",
                "2",
                "3"
              ]
            },
            {
              "name": "color",
              "slot_type": "string",
              "description": "What color would you prefer?",
              "required": true,
              "examples": [
                "black",
                "white",
                "silver"
              ]
            },
            {
              "name": "size",
              "slot_type": "string",
              "description": "What size do you need?",
              "required": true,
              "examples": [
                "small",
                "medium",
                "large"
              ]
            },
            {
              "name": "shipping_address",
              "slot_type": "address",
              "description": "What's the shipping address?",
              "required": true,
              "examples": [
                "123 Main St",
                "456 Oak Ave",
                "789 Pine Rd"
              ]
            }
          ],
          "current_slots": [],
          "expected_slot": "product",
          "conversation_state": "idle"
        },
        "result": {
          "commands": [
            {
              "type": "start_flow",
              "flow_name": "search_product",
              "slots": {}
            },
            {
              "type": "set_slot",
              "slot": "quantity",
              "value": "1",
              "confidence": 1.0
            },
            {
              "type": "set_slot",
              "slot": "color",
              "value": "black",
              "confidence": 1.0
            }
          ],
          "confidence": 0.9
        }
      },
      {
        "user_message": "What are your hours?",
        "history": [
          {
            "user_message": "I want to search_product"
          }
        ],
        "context": {
          "available_flows": [
            {
              "name": "search_product",
              "description": "Search for products by name or category",
              "trigger_intents": [
                "I'm looking for a",
                "Show me",
                "I want to buy a",
                "Can you help me find a"
              ]
            },
            {
              "name": "add_to_cart",
              "description": "Add products to your shopping cart",
              "trigger_intents": []
            },
            {
              "name": "checkout",
              "description": "Complete purchase and payment",
              "trigger_intents": []
            },
            {
              "name": "track_order",
              "description": "Track the status of an order shipment",
              "trigger_intents": []
            },
            {
              "name": "return_product",
              "description": "Return a product and get a refund",
              "trigger_intents": []
            }
          ],
          "available_commands": [
            {
              "command_type": "start_flow",
              "description": "Start a new flow",
              "required_fields": [
                "flow_name"
              ],
              "example": ""
            },
            {
              "command_type": "set_slot",
              "description": "Set a slot value",
              "required_fields": [
                "slot",
                "value"
              ],
              "example": ""
            },
            {
              "command_type": "cancel_flow",
              "description": "Cancel the current flow",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "affirm",
              "description": "Confirm a pending action (user says yes)",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "deny",
              "description": "Deny a pending action (user says no)",
              "required_fields": [
                "slot_to_change"
              ],
              "example": ""
            },
            {
              "command_type": "correct_slot",
              "description": "Correct a previously set slot value",
              "required_fields": [
                "slot",
                "new_value"
              ],
              "example": ""
            },
            {
              "command_type": "clarify",
              "description": "User requests clarification about something",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "chitchat",
              "description": "Off-topic conversation or small talk",
              "required_fields": [],
              "example": ""
            }
          ],
          "active_flow": "search_product",
          "flow_slots": [
            {
              "name": "product",
              "slot_type": "string",
              "description": "What product are you looking for?",
              "required": true,
              "examples": [
                "laptop",
                "phone",
                "headphones"
              ]
            },
            {
              "name": "quantity",
              "slot_type": "number",
              "description": "How many would you like to order?",
              "required": true,
              "examples": [
                "1",
                "2",
                "3"
              ]
            },
            {
              "name": "color",
              "slot_type": "string",
              "description": "What color would you prefer?",
              "required": true,
              "examples": [
                "black",
                "white",
                "silver"
              ]
            },
            {
              "name": "size",
              "slot_type": "string",
              "description": "What size do you need?",
              "required": true,
              "examples": [
                "small",
                "medium",
                "large"
              ]
            },
            {
              "name": "shipping_address",
              "slot_type": "address",
              "description": "What's the shipping address?",
              "required": true,
              "examples": [
                "123 Main St",
                "456 Oak Ave",
                "789 Pine Rd"
              ]
            }
          ],
          "current_slots": [
            {
              "name": "product",
              "value": "laptop",
              "expected_type": "string"
            }
          ],
          "expected_slot": "quantity",
          "conversation_state": "collecting"
        },
        "result": {
          "commands": [
            {
              "type": "chitchat",
              "message": "What are your hours?"
            }
          ],
          "confidence": 0.85
        }
      }
    ],
    "signature": {
      "instructions": "As the Understanding Layer of a deterministic dialogue system, your task is to carefully analyze the user's message within the given dialogue context and extract clear, executable commands accordingly. \n\nUtilize the available commands listed in `context.available_commands`, ensuring to follow these guidelines:\n1. Only utilize commands from the provided command set.\n2. If the user supplies a value that corresponds to an expected slot, create a `set_slot` command to capture that input.\n3. If the user seeks to amend a previously provided value, compare it with the current slots and generate a `correct_slot` command to rectify the information.\n4. When the user expresses a desire to initiate a task, identify the appropriate command from the `available_flows` and use `start_flow`.\n5. In situations where the conversation state is set to confirming:\n   - Respond with an `affirm` command for confirmations like \"Yes\" or \"Correct.\"\n   - Utilize a `deny` command for rejections like \"No\" or \"Wrong,\" specifying which slot needs amendment if indicated by the user.\n6. Be precise in your command generationâ€”construct a detailed list of commands that directly address the user's needs based on the dialogue context.\n\nRemember, your goal is to maintain an engaging and seamless user experience by accurately interpreting user intent and providing appropriate responses. Use your reasoning skills effectively!",
      "fields": [
        {
          "prefix": "User Message:",
          "description": "User's input message to analyze"
        },
        {
          "prefix": "Context:",
          "description": "Complete dialogue context including available_flows, available_commands, current_slots, expected_slot"
        },
        {
          "prefix": "History:",
          "description": "Recent conversation history (list of {role, content} messages)"
        },
        {
          "prefix": "Reasoning: Let's think step by step in order to",
          "description": "${reasoning}"
        },
        {
          "prefix": "Result:",
          "description": "Extracted commands and reasoning"
        }
      ]
    },
    "lm": null
  },
  "metadata": {
    "dependency_versions": {
      "python": "3.13",
      "dspy": "3.0.4",
      "cloudpickle": "3.1"
    }
  }
}
