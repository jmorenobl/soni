{
  "extractor.predict": {
    "traces": [],
    "train": [],
    "demos": [
      {
        "augmented": true,
        "user_message": "Yes",
        "context": {
          "available_flows": [
            {
              "name": "transfer_funds",
              "description": "Transfer money between accounts or to other people",
              "trigger_intents": [
                "I want to transfer money",
                "Send funds",
                "Make a payment",
                "Transfer to"
              ]
            },
            {
              "name": "check_balance",
              "description": "Check your account balance or how much money you have",
              "trigger_intents": [
                "What is my balance?",
                "Check my account",
                "How much money do I have",
                "How much do I have?",
                "What's my balance?",
                "Show me my funds",
                "How much is in my account?",
                "What's in my account?"
              ]
            },
            {
              "name": "activate_card",
              "description": "Activate a new debit or credit card",
              "trigger_intents": []
            },
            {
              "name": "block_card",
              "description": "Block a lost or stolen card",
              "trigger_intents": []
            },
            {
              "name": "transaction_history",
              "description": "View recent transactions and account activity",
              "trigger_intents": []
            }
          ],
          "available_commands": [
            {
              "command_type": "start_flow",
              "description": "Start a new flow",
              "required_fields": [
                "flow_name"
              ],
              "example": ""
            },
            {
              "command_type": "set_slot",
              "description": "Set a slot value",
              "required_fields": [
                "slot",
                "value"
              ],
              "example": ""
            },
            {
              "command_type": "cancel_flow",
              "description": "Cancel the current flow",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "affirm",
              "description": "Confirm a pending action (user says yes)",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "deny",
              "description": "Deny a pending action (user says no)",
              "required_fields": [
                "slot_to_change"
              ],
              "example": ""
            },
            {
              "command_type": "correct_slot",
              "description": "Correct a previously set slot value",
              "required_fields": [
                "slot",
                "new_value"
              ],
              "example": ""
            },
            {
              "command_type": "clarify",
              "description": "User requests clarification about something",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "chitchat",
              "description": "Off-topic conversation or small talk",
              "required_fields": [],
              "example": ""
            }
          ],
          "active_flow": "transfer_funds",
          "flow_slots": [
            {
              "name": "amount",
              "slot_type": "number",
              "description": "How much would you like to transfer?",
              "required": true,
              "examples": [
                "10",
                "50",
                "100"
              ]
            },
            {
              "name": "currency",
              "slot_type": "string",
              "description": "In which currency?",
              "required": true,
              "examples": [
                "USD",
                "EUR",
                "GBP"
              ]
            },
            {
              "name": "recipient",
              "slot_type": "string",
              "description": "Who would you like to send money to?",
              "required": true,
              "examples": [
                "mom",
                "dad",
                "landlord"
              ]
            },
            {
              "name": "account_type",
              "slot_type": "string",
              "description": "Which account (checking or savings)?",
              "required": true,
              "examples": [
                "checking",
                "savings",
                "current"
              ]
            },
            {
              "name": "card_last_4",
              "slot_type": "number",
              "description": "What are the last 4 digits of the card?",
              "required": true,
              "examples": [
                "1234",
                "5678",
                "9012"
              ]
            }
          ],
          "current_slots": [
            {
              "name": "amount",
              "value": "10",
              "expected_type": "number"
            },
            {
              "name": "currency",
              "value": "USD",
              "expected_type": "string"
            },
            {
              "name": "recipient",
              "value": "mom",
              "expected_type": "string"
            }
          ],
          "expected_slot": null,
          "conversation_state": "confirming"
        },
        "history": {
          "messages": [
            {
              "user_message": "Confirm: {'amount': '10', 'currency': 'USD', 'recipient': 'mom'}?"
            }
          ]
        },
        "reasoning": "The user has confirmed the action to transfer funds with the specified amount, currency, and recipient. Since the conversation state is \"confirming\" and the user responded with \"Yes,\" we will generate an affirm command to proceed with the transfer.",
        "result": {
          "commands": [
            {
              "type": "affirm"
            }
          ],
          "confidence": 1.0
        }
      },
      {
        "user_message": "I need a hotel reservation",
        "history": [],
        "context": {
          "available_flows": [
            {
              "name": "book_hotel",
              "description": "Book hotel rooms in different cities",
              "trigger_intents": [
                "I want to book a hotel",
                "Book a hotel room",
                "I need a hotel reservation",
                "Can you help me book a hotel"
              ]
            },
            {
              "name": "search_hotels",
              "description": "Search for available hotels and compare options",
              "trigger_intents": []
            },
            {
              "name": "check_reservation",
              "description": "Check the status of an existing reservation",
              "trigger_intents": []
            },
            {
              "name": "modify_reservation",
              "description": "Modify an existing hotel reservation",
              "trigger_intents": []
            },
            {
              "name": "cancel_reservation",
              "description": "Cancel a hotel reservation",
              "trigger_intents": []
            }
          ],
          "available_commands": [
            {
              "command_type": "start_flow",
              "description": "Start a new flow",
              "required_fields": [
                "flow_name"
              ],
              "example": ""
            },
            {
              "command_type": "set_slot",
              "description": "Set a slot value",
              "required_fields": [
                "slot",
                "value"
              ],
              "example": ""
            },
            {
              "command_type": "cancel_flow",
              "description": "Cancel the current flow",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "affirm",
              "description": "Confirm a pending action (user says yes)",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "deny",
              "description": "Deny a pending action (user says no)",
              "required_fields": [
                "slot_to_change"
              ],
              "example": ""
            },
            {
              "command_type": "correct_slot",
              "description": "Correct a previously set slot value",
              "required_fields": [
                "slot",
                "new_value"
              ],
              "example": ""
            },
            {
              "command_type": "clarify",
              "description": "User requests clarification about something",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "chitchat",
              "description": "Off-topic conversation or small talk",
              "required_fields": [],
              "example": ""
            }
          ],
          "active_flow": null,
          "flow_slots": [
            {
              "name": "location",
              "slot_type": "city",
              "description": "Which city would you like to stay in?",
              "required": true,
              "examples": [
                "Madrid",
                "Barcelona",
                "Paris"
              ]
            },
            {
              "name": "checkin_date",
              "slot_type": "date",
              "description": "When would you like to check in?",
              "required": true,
              "examples": [
                "tomorrow",
                "next Monday",
                "December 15th"
              ]
            },
            {
              "name": "checkout_date",
              "slot_type": "date",
              "description": "When would you like to check out?",
              "required": true,
              "examples": [
                "next Friday",
                "December 20th",
                "in a week"
              ]
            },
            {
              "name": "guests",
              "slot_type": "number",
              "description": "How many guests will be staying?",
              "required": true,
              "examples": [
                "1",
                "2",
                "3"
              ]
            },
            {
              "name": "room_type",
              "slot_type": "string",
              "description": "What type of room would you prefer? (single, double, suite)",
              "required": true,
              "examples": [
                "single",
                "double",
                "suite"
              ]
            }
          ],
          "current_slots": [],
          "expected_slot": null,
          "conversation_state": "idle"
        },
        "result": {
          "commands": [
            {
              "type": "start_flow",
              "flow_name": "book_hotel",
              "slots": {}
            }
          ],
          "confidence": 0.9
        }
      },
      {
        "user_message": "No",
        "history": [
          {
            "user_message": "Confirm: {'location': 'Madrid', 'date': 'tomorrow', 'time': '7:00 PM'}?"
          }
        ],
        "context": {
          "available_flows": [
            {
              "name": "book_table",
              "description": "Make restaurant reservations",
              "trigger_intents": [
                "I want to make a reservation",
                "Book a table",
                "I need a restaurant reservation",
                "Can you help me book a table"
              ]
            },
            {
              "name": "search_restaurants",
              "description": "Search for restaurants by cuisine and location",
              "trigger_intents": []
            },
            {
              "name": "check_reservation",
              "description": "Check the status of an existing restaurant reservation",
              "trigger_intents": []
            },
            {
              "name": "modify_reservation",
              "description": "Modify an existing restaurant reservation",
              "trigger_intents": []
            },
            {
              "name": "cancel_reservation",
              "description": "Cancel a restaurant reservation",
              "trigger_intents": []
            }
          ],
          "available_commands": [
            {
              "command_type": "start_flow",
              "description": "Start a new flow",
              "required_fields": [
                "flow_name"
              ],
              "example": ""
            },
            {
              "command_type": "set_slot",
              "description": "Set a slot value",
              "required_fields": [
                "slot",
                "value"
              ],
              "example": ""
            },
            {
              "command_type": "cancel_flow",
              "description": "Cancel the current flow",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "affirm",
              "description": "Confirm a pending action (user says yes)",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "deny",
              "description": "Deny a pending action (user says no)",
              "required_fields": [
                "slot_to_change"
              ],
              "example": ""
            },
            {
              "command_type": "correct_slot",
              "description": "Correct a previously set slot value",
              "required_fields": [
                "slot",
                "new_value"
              ],
              "example": ""
            },
            {
              "command_type": "clarify",
              "description": "User requests clarification about something",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "chitchat",
              "description": "Off-topic conversation or small talk",
              "required_fields": [],
              "example": ""
            }
          ],
          "active_flow": "book_table",
          "flow_slots": [
            {
              "name": "location",
              "slot_type": "city",
              "description": "Which city are you looking for a restaurant in?",
              "required": true,
              "examples": [
                "Madrid",
                "Barcelona",
                "Paris"
              ]
            },
            {
              "name": "date",
              "slot_type": "date",
              "description": "What date would you like to dine?",
              "required": true,
              "examples": [
                "tomorrow",
                "next Friday",
                "Saturday"
              ]
            },
            {
              "name": "time",
              "slot_type": "time",
              "description": "What time would you prefer?",
              "required": true,
              "examples": [
                "7:00 PM",
                "8:00 PM",
                "7:30 PM"
              ]
            },
            {
              "name": "party_size",
              "slot_type": "number",
              "description": "How many people will be dining?",
              "required": true,
              "examples": [
                "2",
                "4",
                "6"
              ]
            },
            {
              "name": "cuisine",
              "slot_type": "string",
              "description": "What type of cuisine would you like?",
              "required": true,
              "examples": [
                "Italian",
                "Japanese",
                "Spanish"
              ]
            }
          ],
          "current_slots": [
            {
              "name": "location",
              "value": "Madrid",
              "expected_type": "city"
            },
            {
              "name": "date",
              "value": "tomorrow",
              "expected_type": "date"
            },
            {
              "name": "time",
              "value": "7:00 PM",
              "expected_type": "time"
            }
          ],
          "expected_slot": null,
          "conversation_state": "confirming"
        },
        "result": {
          "commands": [
            {
              "type": "deny",
              "slot_to_change": null
            }
          ],
          "confidence": 0.95
        }
      },
      {
        "user_message": "Can I modify the location?",
        "history": [
          {
            "user_message": "location: Madrid"
          }
        ],
        "context": {
          "available_flows": [
            {
              "name": "book_table",
              "description": "Make restaurant reservations",
              "trigger_intents": [
                "I want to make a reservation",
                "Book a table",
                "I need a restaurant reservation",
                "Can you help me book a table"
              ]
            },
            {
              "name": "search_restaurants",
              "description": "Search for restaurants by cuisine and location",
              "trigger_intents": []
            },
            {
              "name": "check_reservation",
              "description": "Check the status of an existing restaurant reservation",
              "trigger_intents": []
            },
            {
              "name": "modify_reservation",
              "description": "Modify an existing restaurant reservation",
              "trigger_intents": []
            },
            {
              "name": "cancel_reservation",
              "description": "Cancel a restaurant reservation",
              "trigger_intents": []
            }
          ],
          "available_commands": [
            {
              "command_type": "start_flow",
              "description": "Start a new flow",
              "required_fields": [
                "flow_name"
              ],
              "example": ""
            },
            {
              "command_type": "set_slot",
              "description": "Set a slot value",
              "required_fields": [
                "slot",
                "value"
              ],
              "example": ""
            },
            {
              "command_type": "cancel_flow",
              "description": "Cancel the current flow",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "affirm",
              "description": "Confirm a pending action (user says yes)",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "deny",
              "description": "Deny a pending action (user says no)",
              "required_fields": [
                "slot_to_change"
              ],
              "example": ""
            },
            {
              "command_type": "correct_slot",
              "description": "Correct a previously set slot value",
              "required_fields": [
                "slot",
                "new_value"
              ],
              "example": ""
            },
            {
              "command_type": "clarify",
              "description": "User requests clarification about something",
              "required_fields": [],
              "example": ""
            },
            {
              "command_type": "chitchat",
              "description": "Off-topic conversation or small talk",
              "required_fields": [],
              "example": ""
            }
          ],
          "active_flow": "book_table",
          "flow_slots": [
            {
              "name": "location",
              "slot_type": "city",
              "description": "Which city are you looking for a restaurant in?",
              "required": true,
              "examples": [
                "Madrid",
                "Barcelona",
                "Paris"
              ]
            },
            {
              "name": "date",
              "slot_type": "date",
              "description": "What date would you like to dine?",
              "required": true,
              "examples": [
                "tomorrow",
                "next Friday",
                "Saturday"
              ]
            },
            {
              "name": "time",
              "slot_type": "time",
              "description": "What time would you prefer?",
              "required": true,
              "examples": [
                "7:00 PM",
                "8:00 PM",
                "7:30 PM"
              ]
            },
            {
              "name": "party_size",
              "slot_type": "number",
              "description": "How many people will be dining?",
              "required": true,
              "examples": [
                "2",
                "4",
                "6"
              ]
            },
            {
              "name": "cuisine",
              "slot_type": "string",
              "description": "What type of cuisine would you like?",
              "required": true,
              "examples": [
                "Italian",
                "Japanese",
                "Spanish"
              ]
            }
          ],
          "current_slots": [
            {
              "name": "location",
              "value": "Madrid",
              "expected_type": "city"
            }
          ],
          "expected_slot": null,
          "conversation_state": "collecting"
        },
        "result": {
          "commands": [
            {
              "type": "deny",
              "slot_to_change": "location"
            }
          ],
          "confidence": 0.9
        }
      }
    ],
    "signature": {
      "instructions": "Translate the User's Message into a structured list of Commands by analyzing it within the provided dialogue context. Your role is to understand user intents and leverage available commands specified in `context.available_commands`. Follow these guidelines:\n\n1. Use only commands from `context.available_commands`.\n2. If the user provides a value and there is an 'expected_slot', generate a `set_slot` command.\n3. If the user corrects a value, check 'current_slots' and issue a `correct_slot` command.\n4. If the user initiates a task, determine the appropriate flow from 'available_flows' and use `start_flow`.\n5. If the conversation state is 'confirming', use:\n   - \"Yes/Correct\" to generate an `affirm` command.\n   - \"No/Wrong\" to generate a `deny` command, including any specified slot name for changes.\n6. Be explicit and ensure you generate only the necessary commands.\n\nKeep your analysis clear, aligning with the context and history to produce accurate command outputs for effective dialogue handling.",
      "fields": [
        {
          "prefix": "User Message:",
          "description": "User's input message to analyze"
        },
        {
          "prefix": "Context:",
          "description": "Complete dialogue context including available_flows, available_commands, current_slots, expected_slot"
        },
        {
          "prefix": "History:",
          "description": "Recent conversation history (list of {role, content} messages)"
        },
        {
          "prefix": "Reasoning: Let's think step by step in order to",
          "description": "${reasoning}"
        },
        {
          "prefix": "Result:",
          "description": "Extracted commands and reasoning"
        }
      ]
    },
    "lm": null
  },
  "metadata": {
    "dependency_versions": {
      "python": "3.13",
      "dspy": "3.0.4",
      "cloudpickle": "3.1"
    }
  }
}
